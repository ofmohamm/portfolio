---
interface Props {
  title: string;
  slug: string;
  description: string;
  tags: string[];
  image?: string;
  video?: string;
  featured?: boolean;
  hoverEffect?: 'pop' | 'wiggle';
  imageStyle?: 'cover' | 'contain';
}

const { title, slug, description, tags, image, video, featured = false, hoverEffect = 'pop', imageStyle = 'cover' } = Astro.props;
---

<article class="project-card group bg-bg-card border-3 border-border rounded-xl overflow-hidden transition-all duration-400 hover:-translate-y-2 hover:border-green-primary hover:shadow-[var(--shadow-hover)]">
  <a href={`/projects/${slug}`} class="block">
    <!-- Video or Image -->
    <div class:list={["aspect-video overflow-hidden", imageStyle === 'contain' ? 'bg-[#E0E0E0] flex items-center justify-center' : 'bg-bg-secondary']}>
      {video ? (
        <video
          src={video}
          autoplay
          loop
          muted
          playsinline
          class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
        />
      ) : image && imageStyle === 'contain' ? (
        <img
          src={image}
          alt={`${title} project preview`}
          class:list={[
            "max-h-full max-w-full object-contain p-3 transition-transform duration-300",
            hoverEffect === 'wiggle' ? 'hover-wiggle' : 'group-hover:scale-105'
          ]}
          loading="lazy"
        />
      ) : image ? (
        <img
          src={image}
          alt={`${title} project preview`}
          class:list={[
            "w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",
            slug === 'bluetooth' && 'scale-110'
          ]}
          loading="lazy"
        />
      ) : (
        <div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-green-bg to-bg-secondary relative">
          <span class="text-green-primary font-heading text-lg font-medium px-4 text-center">
            {title}
          </span>
        </div>
      )}
    </div>

    <div class="p-5 lg:p-6">
      <h3 class="font-heading text-xl font-semibold text-text-primary mb-3 group-hover:text-green-primary transition-colors">
        {title}
      </h3>

      <div class="flex flex-wrap gap-2 mb-3">
        {tags.slice(0, 4).map((tag) => (
          <span class="inline-block px-3 py-1 bg-green-bg text-green-primary text-xs font-medium rounded-full">
            {tag}
          </span>
        ))}
      </div>

      <p class="text-text-secondary text-sm line-clamp-2">
        {description}
      </p>
    </div>
  </a>
</article>

<style>
  .border-3 {
    border-width: 3px;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .duration-400 {
    transition-duration: 400ms;
  }

  .project-card {
    transition-timing-function: cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .project-card:hover .hover-wiggle {
    animation: wiggle 0.6s ease-in-out;
  }
</style>
